---
allowed-tools: Read, Glob, Grep, Write, Edit, AskUserQuestion, mcp__serena__list_memories, mcp__serena__read_memory, mcp__serena__write_memory, mcp__serena__edit_memory
description: 要件定義を対話的に作成・改善する。新機能の仕様策定や既存要件のブラッシュアップに使用。
---

# /requirements コマンド

## 概要

ユーザーと対話しながら要件を明確化し、構造化されたドキュメントを作成するスキル。

## 使用方法

```bash
/requirements                         # 新規要件定義を開始
/requirements refine <機能名>          # 既存要件を見直す
/requirements <機能のアイデア>          # アイデアから要件を作成
```

## 実行手順

### Step 1: メモリの確認（必須）

1. `list_memories` で既存メモリを確認
2. `user-personas` があれば読み込む
3. `competitor-analysis` があれば読み込む

### Step 2: ヒアリング開始

**最初に聞く3つの質問**（AskUserQuestion ツールを使用）:

1. 「この機能を使うのは誰？」
   - 田中さん（週末GM・30代）: 日程調整やシナリオ探しを効率化したい
   - 鈴木さん（新人PL・20代）: 初心者向けセッションを見つけたい
   - 佐藤さん（配信者・20代）: 動画とセッションを連携したい
   - 山田さん（ベテランKP・40代）: 所持シナリオの管理とマッチング

2. 「具体的にどんな状況で使う？」
   - シナリオA: セッションを企画する
   - シナリオB: セッションに参加する
   - シナリオC: シナリオを探す

3. 「今はどうやってる？何が不便？」

### Step 3: 詳細ヒアリング

**操作フローを確認**:
- 「最初に何をクリックする？」
- 「何を入力する？」
- 「結果として何が見える？」

**TRPG特有の確認**:
- ネタバレの可能性は？
- 荒らし対策は必要？
- GM/PLで見える情報は変わる？

### Step 4: ドキュメント化

要件が固まったら `.claude/rules/requirements-<機能名>.md` に出力。

## 出力フォーマット

```markdown
# [機能名] 要件定義書

## 1. 概要
### 1.1 目的
この機能が解決する課題を1-2文で。

### 1.2 対象ユーザー
主に利用するペルソナを明記。

### 1.3 ユーザーストーリー
「〇〇として、△△したい。なぜなら□□だから。」

## 2. 機能要件
### 2.1 画面・操作フロー
### 2.2 データ項目
### 2.3 ビジネスルール

## 3. TRPGセッション固有の考慮事項
### 3.1 ネタバレ保護
### 3.2 荒らし対策

## 4. 実装の優先度
### 4.1 MVP（必須）
### 4.2 Nice to Have（後回し可）

## 5. 未決定事項
```

## ヒアリングのコツ

1. **2-3問ずつ質問**: 一度に大量に聞かない
2. **具体例を出す**: 「例えばCoC7版で4人セッションのとき...」
3. **選択肢を提示**: 「AとBどちらに近い？」
4. **要約で確認**: 「つまり〇〇ということですね？」

## ナレッジ蓄積

新しいペルソナや利用シーンを発見したら、対話終了時に `user-personas` メモリに追記する。

蓄積すべき情報:
- 既存4ペルソナに当てはまらない新ペルソナ
- 既存シナリオA/B/Cに当てはまらない利用シーン
- 要件に影響する具体的な悩み
- ドメイン用語（「野良卓」「身内卓」等）

## 参照ファイル

| ファイル | 用途 |
|----------|------|
| `.claude/rules/requirements-v1.md` | 既存要件との整合性確認 |
| `user-personas` メモリ | ペルソナ・利用シーン |
| `competitor-analysis` メモリ | 競合分析 |

## 質問フレームワーク（チートシート）

### Phase 1: 誰が・いつ・何を
- 一番使うのは誰？
- どんな状況で？
- 今の方法と何が不便？

### Phase 2: どうやって
- 最初の操作は？
- 入力するものは？
- 結果として何が見える？

### Phase 3: TRPG特有
- ネタバレリスクは？
- 荒らし対策は？
- 権限管理は？

### Phase 4: 優先度
- MVPは？
- あったら嬉しいけど後でいい機能は？
